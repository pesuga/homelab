# Fixed Authentik Server Service with Port 80 Mapping
# Compliant with Golden Rules: port 80 â†’ targetPort (container port)
apiVersion: v1
kind: Service
metadata:
  name: authentik-server
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik
    app.kubernetes.io/component: server
spec:
  type: ClusterIP
  selector:
    app: authentik-server
  ports:
  - name: http
    port: 80          # Standard HTTP port for IngressRoute
    protocol: TCP
    targetPort: 9000  # Container port
  - name: http-alt
    port: 9000        # Keep original port for backward compatibility
    protocol: TCP
    targetPort: 9000
  - name: https
    port: 9443
    protocol: TCP
    targetPort: 9443
